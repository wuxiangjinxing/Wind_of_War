["emp_sword10", "Reikland_Bastard_Sword", [("Sword_Empire_J_01", 0), ("Sword_Empire_J_Scabbard", ixmesh_carry)], itp_type_two_handed_wpn|itp_merchandise|itp_primary, 9223635954298781951, 1800, weight(7)|abundance(100)|difficulty(9)|weapon_length(98)|spd_rtng(70)|swing_damage(40, pierce)|thrust_damage(25, pierce), imodbits_sword_high], 
["emp_sword4", "Reikland_Bastard_Sword", [("Sword_Empire_D_01", 0), ("Sword_Empire_D_Scabbard", ixmesh_carry)], itp_type_two_handed_wpn|itp_merchandise|itp_primary, 9223635954298781951, 800, weight(5)|abundance(100)|difficulty(9)|weapon_length(103)|spd_rtng(80)|swing_damage(20, pierce)|thrust_damage(20, pierce), imodbits_sword_high], 

["emp_sword13", "Reikland_Katzbalger", [("Sword_Empire_M_01", 0), ("Sword_Empire_M_Scabbard", ixmesh_carry)], itp_type_one_handed_wpn|itp_merchandise|itp_primary, 9223388564182532111, 900, weight(5)|abundance(100)|difficulty(0)|weapon_length(66)|spd_rtng(90)|swing_damage(30, cut)|thrust_damage(25, cut), imodbits_sword_high], 
["emp_sword14", "Reikland_Katzbalger", [("Sword_Empire_N_01", 0), ("Sword_Empire_N_Scabbard", ixmesh_carry)], itp_type_one_handed_wpn|itp_merchandise|itp_primary, 9223388564182532111, 950, weight(5)|abundance(100)|difficulty(0)|weapon_length(66)|spd_rtng(90)|swing_damage(30, cut)|thrust_damage(20, cut), imodbits_sword_high], 


["emp_halberd1", "Imperial_Helmbarte", [("Halberd_Heavy_A_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 1000, weight(10)|abundance(100)|difficulty(12)|weapon_length(183)|spd_rtng(65)|swing_damage(50, pierce)|thrust_damage(25, cut), imodbits_axe], 
["emp_halberd2", "Imperial_Helmbarte", [("Halberd_Heavy_B_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 1200, weight(11)|abundance(100)|difficulty(12)|weapon_length(180)|spd_rtng(60)|swing_damage(50, pierce)|thrust_damage(25, cut), imodbits_axe], 
["emp_halberd3", "Imperial_Helmbarte", [("Halberd_Heavy_C_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 1300, weight(12)|abundance(100)|difficulty(12)|weapon_length(201)|spd_rtng(59)|swing_damage(51, pierce)|thrust_damage(25, cut), imodbits_axe], 

["emp_halberd6", "Imperial_Helmbarte", [("Halberd_Light_B_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 200, weight(7)|abundance(100)|difficulty(12)|weapon_length(168)|spd_rtng(70)|swing_damage(31, cut)|thrust_damage(20, cut), imodbits_axe], 
["emp_halberd8", "Imperial_Helmbarte", [("Halberd_Light_D_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 500, weight(8)|abundance(100)|difficulty(12)|weapon_length(190)|spd_rtng(70)|swing_damage(40, cut)|thrust_damage(25, cut), imodbits_axe], 
["emp_halberd9", "Imperial_Helmbarte", [("Halberd_Medium_A_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 600, weight(9)|abundance(100)|difficulty(12)|weapon_length(182)|spd_rtng(61)|swing_damage(15, pierce)|thrust_damage(24, cut), imodbits_axe], 
["emp_halberd10", "Imperial_Helmbarte", [("Halberd_Medium_B_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 730, weight(9.500000)|abundance(100)|difficulty(12)|weapon_length(178)|spd_rtng(64)|swing_damage(23, pierce)|thrust_damage(24, cut), imodbits_axe], 
["emp_halberd11", "Imperial_Helmbarte", [("Halberd_Medium_C_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 840, weight(9)|abundance(100)|difficulty(12)|weapon_length(183)|spd_rtng(65)|swing_damage(31, pierce)|thrust_damage(24, cut), imodbits_axe], 
["emp_halberd12", "Imperial_Helmbarte", [("Halberd_Medium_D_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_cant_use_on_horseback, 4222124851990272, 900, weight(10)|abundance(100)|difficulty(12)|weapon_length(182)|spd_rtng(60)|swing_damage(39, pierce)|thrust_damage(24, cut), imodbits_axe], 
  
["emp_spear1", "Heavy_Linear_Spear", [("Spear_Heavy_A_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_primary|itp_penalty_with_shield, 13229330079416576, 1000, weight(3.500000)|abundance(100)|difficulty(0)|weapon_length(200)|spd_rtng(63)|swing_damage(35, pierce)|thrust_damage(50, pierce), imodbits_polearm], 
["emp_spear2", "Imperial_Linear_Spear", [("Spear_Heavy_B_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_primary|itp_penalty_with_shield, 13229330079416576, 1300, weight(3.500000)|abundance(100)|difficulty(0)|weapon_length(195)|spd_rtng(56)|swing_damage(41, pierce)|thrust_damage(58, pierce), imodbits_polearm], 
["emp_spear3", "Imperial_Linear_Spear", [("Spear_Light_A_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_primary|itp_penalty_with_shield, 13229330079416576, 50, weight(5)|abundance(100)|difficulty(0)|weapon_length(170)|spd_rtng(85)|swing_damage(15, pierce)|thrust_damage(20, pierce), imodbits_polearm], 
["emp_spear4", "Imperial_Linear_Spear", [("Spear_Light_B_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_primary|itp_penalty_with_shield, 13229330079416576, 150, weight(5)|abundance(100)|difficulty(0)|weapon_length(180)|spd_rtng(80)|swing_damage(15, pierce)|thrust_damage(25, pierce), imodbits_polearm], 
["emp_spear5", "Imperial_Sigmarite_Spear", [("Spear_Medium_A_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_primary|itp_penalty_with_shield, 13229330079416576, 400, weight(7)|abundance(100)|difficulty(0)|weapon_length(180)|spd_rtng(77)|swing_damage(25, pierce)|thrust_damage(40, pierce), imodbits_polearm], 
["emp_spear6", "Imperial_Hook_Spear", [("Spear_Medium_B_01", 0)], itp_type_polearm|itp_merchandise|itp_wooden_parry|itp_primary|itp_penalty_with_shield, 13229330079416576, 700, weight(8)|abundance(100)|difficulty(0)|weapon_length(185)|spd_rtng(70)|swing_damage(25, pierce)|thrust_damage(42, pierce), imodbits_polearm], 
  
  
["change_axe", "Axe_of_Change", [("WAoRChaosAxeD", 0)], itp_type_one_handed_wpn|itp_unique|itp_wooden_parry|itp_primary|itp_secondary|itp_bonus_against_shield, itc_scimitar|itcf_carry_axe_left_hip, 7500, weight(5)|abundance(100)|difficulty(11)|weapon_length(120)|spd_rtng(87)|swing_damage(75, cut)|thrust_damage(0, pierce), imodbits_axe], 
  
  
  
["dwarf_spanner", "Dwarven_Runic_Spanner", [("dw_spanner", 0)], itp_type_two_handed_wpn|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield, itc_nodachi|itcf_carry_axe_back, 825, weight(9)|abundance(100)|difficulty(12)|weapon_length(99)|spd_rtng(90)|swing_damage(38, blunt)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
  
["dwarf_axe", "Dwarven_Axe", [("one_handed_dwarf_axe_1", 0)], itp_type_one_handed_wpn|itp_merchandise|itp_wooden_parry|itp_primary|itp_secondary|itp_bonus_against_shield, itc_scimitar|itcf_carry_axe_left_hip, 51, weight(2)|abundance(100)|difficulty(7)|weapon_length(54)|spd_rtng(94)|swing_damage(32, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_hand_axe", "Dwarven_One_Handed_Axe", [("one_handed_dwarf_axe_2", 0)], itp_type_one_handed_wpn|itp_merchandise|itp_wooden_parry|itp_primary|itp_secondary|itp_bonus_against_shield, itc_scimitar|itcf_carry_axe_left_hip, 77, weight(2.500000)|abundance(100)|difficulty(7)|weapon_length(58)|spd_rtng(93)|swing_damage(35, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_fighting_axe", "Dwarven_Fighting_Axe", [("one_handed_dwarf_axe_3", 0)], itp_type_one_handed_wpn|itp_merchandise|itp_wooden_parry|itp_primary|itp_secondary|itp_bonus_against_shield, itc_scimitar|itcf_carry_axe_left_hip, 150, weight(2.500000)|abundance(100)|difficulty(9)|weapon_length(63)|spd_rtng(95)|swing_damage(33, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_battle_axe", "Dwarven_Battle_Axe", [("one_handed_dwarf_axe_5", 0)], itp_type_one_handed_wpn|itp_merchandise|itp_wooden_parry|itp_primary|itp_secondary|itp_bonus_against_shield, itc_scimitar|itcf_carry_axe_left_hip, 610, weight(2.500000)|abundance(100)|difficulty(11)|weapon_length(60)|spd_rtng(95)|swing_damage(38, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_runic_axe", "Dwarven_Runic_Axe", [("one_handed_dwarf_axe_4", 0)], itp_type_one_handed_wpn|itp_merchandise|itp_wooden_parry|itp_primary|itp_secondary|itp_bonus_against_shield, itc_scimitar|itcf_carry_axe_left_hip, 570, weight(2.500000)|abundance(100)|difficulty(9)|weapon_length(57)|spd_rtng(95)|swing_damage(37, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_iron_axe", "Dwarven_Iron_Axe", [("one_handed_dwarf_axe_6", 0)], itp_type_one_handed_wpn|itp_merchandise|itp_wooden_parry|itp_primary|itp_secondary|itp_bonus_against_shield, itc_scimitar|itcf_carry_axe_left_hip, 560, weight(1.750000)|abundance(100)|difficulty(10)|weapon_length(62)|spd_rtng(102)|swing_damage(36, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_lordrunic_axe", "Dwarven_Lord_Runic_Axe", [("one_handed_dwarf_axe_7", 0)], itp_type_one_handed_wpn|itp_unique|itp_wooden_parry|itp_primary|itp_secondary|itp_bonus_against_shield, itc_scimitar|itcf_carry_axe_left_hip, 760, weight(1.750000)|abundance(100)|difficulty(13)|weapon_length(62)|spd_rtng(105)|swing_damage(54, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
  
["dwarf_long_axe", "Dwarven_Two_Handed_Axe", [("two_handed_dwarf_axe_1", 0)], itp_type_two_handed_wpn|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_unbalanced, itc_nodachi|itcf_carry_axe_back, 455, weight(4)|abundance(100)|difficulty(10)|weapon_length(107)|spd_rtng(88)|swing_damage(45, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_long_axe_2", "Dwarven_Lord_Great_Axe", [("two_handed_dwarf_axe_2", 0)], itp_type_two_handed_wpn|itp_unique|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield, itc_nodachi|itcf_carry_axe_back, 950, weight(4.500000)|abundance(100)|difficulty(12)|weapon_length(115)|spd_rtng(90)|swing_damage(51, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_2]], 
["dwarf_long_axe_3", "Dwarven_Slayer_Axe", [("two_handed_dwarf_axe_4", 0)], itp_type_two_handed_wpn|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield, itc_nodachi|itcf_carry_axe_back, 690, weight(4)|abundance(100)|difficulty(12)|weapon_length(90)|spd_rtng(86)|swing_damage(55, pierce)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_long_axe_4", "Dwarven_Dragon_Axe", [("two_handed_dwarf_axe_3", 0)], itp_type_two_handed_wpn|itp_unique|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield, itc_nodachi|itcf_carry_axe_back, 30000, weight(4.500000)|abundance(100)|difficulty(13)|weapon_length(98)|spd_rtng(86)|swing_damage(60, pierce)|thrust_damage(0, pierce), imodbits_axe], 

["trgwa",         "trgwa", [("two_handed_dwarf_axe_2",0)], itp_type_two_handed_wpn|itp_primary|itp_two_handed|itp_bonus_against_shield|itp_extra_penetration|itp_wooden_parry|itp_unbalanced, itc_staff|itcf_carry_axe_back, 2000 , weight(7)|difficulty(15)|spd_rtng(88)| weapon_length(120)|swing_damage(50 , pierce)| thrust_damage(0 ,  pierce),imodbits_axe|imodbit_masterwork ],
["drawf_double_axe", "Double Axe", [("two_handed_dwarf_axe_4",0)], itp_type_two_handed_wpn|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield|itp_can_knock_down|itp_crush_through|itp_unbalanced|itp_extra_penetration, itc_staff|itcf_carry_axe_back, 959, weight(6.5)|difficulty(9)|spd_rtng(85)|weapon_length(80)|swing_damage(50,pierce)|thrust_damage(0,pierce), imodbits_axe|imodbit_masterwork, [], ne_faction],



["axe_of_grimnir", "Dwarven_Dragon_Axe", [("two_handed_dwarf_axe_3", 0)], itp_type_two_handed_wpn|itp_unique|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield, itc_nodachi|itcf_carry_axe_back, 30000, weight(4.500000)|abundance(100)|difficulty(13)|weapon_length(98)|spd_rtng(86)|swing_damage(80, cut)|thrust_damage(0, pierce), imodbits_axe], 

["grudge_hammer", "Grudge_Hammer", [("dwtwo_hand_hammer", 0)], itp_type_two_handed_wpn|itp_unique|itp_wooden_attack|itp_wooden_parry|itp_two_handed|itp_primary|itp_crush_through|itp_unbalanced|itp_can_knock_down, 9223635925844623584, 12000, weight(7)|abundance(100)|difficulty(12)|weapon_length(93)|spd_rtng(9)|swing_damage(70, blunt)|thrust_damage(0, pierce), imodbits_axe], 
["klad_barak", "Klad_Barak", [("dwtwo_hand_hammer", 0)], itp_type_two_handed_wpn|itp_unique|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield, itc_nodachi|itcf_carry_axe_back, 450, weight(10)|abundance(100)|difficulty(14)|weapon_length(92)|spd_rtng(92)|swing_damage(60, blunt)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 



  
  
  
  
  
  
["slayer_great_axe", "Slayer_Great_Axe", [("dwarf_great_ax", 0)], itp_type_two_handed_wpn|itp_merchandise|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield, itc_nodachi|itcf_carry_axe_back, 855, weight(4.500000)|abundance(100)|difficulty(13)|weapon_length(117)|spd_rtng(85)|swing_damage(52, cut)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
["dwarf_lord_great_axe", "Dwarven_Lord_Great_Axe", [("two_handed_dwarf_axe_2", 0)], itp_type_two_handed_wpn|itp_unique|itp_wooden_parry|itp_two_handed|itp_primary|itp_bonus_against_shield, itc_nodachi|itcf_carry_axe_back, 950, weight(4.500000)|abundance(100)|difficulty(12)|weapon_length(115)|spd_rtng(90)|swing_damage(51, cut)|thrust_damage(0, pierce), imodbits_axe, [], [fac_kingdom_10]], 
  
  
  ("relations_with_factions", 0, mesh_load_window, [
    (ti_on_presentation_load,
      [
        (presentation_set_duration, 999999),
        (set_fixed_point_multiplier, 1000),
        
        (create_text_overlay, reg1, "@Relation with the factions", tf_center_justify),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 670),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 1500),
        (position_set_y, pos1, 1500),
        (overlay_set_size, reg1, pos1),
        
        (create_text_overlay, reg1, "@Click the banner to view relation with the lords", tf_center_justify),
        (position_set_x, pos1, 500),
        (position_set_y, pos1, 50),
        (overlay_set_position, reg1, pos1),
        (position_set_x, pos1, 800),
        (position_set_y, pos1, 800),
        (overlay_set_size, reg1, pos1),
        
        (str_clear, s0),
        (create_text_overlay, "$g_presentation_obj_6", s0, tf_scrollable),
        (position_set_x, pos1, 15),
        (position_set_y, pos1, 80),
        (overlay_set_position, "$g_presentation_obj_6", pos1),
        (position_set_x, pos1, 950),
        (position_set_y, pos1, 570),
        (overlay_set_area_size, "$g_presentation_obj_6", pos1),
        (set_container_overlay, "$g_presentation_obj_6"),
        
        (assign, ":num_active_factions", 0),
        (try_for_range, ":cur_kingdom", kingdoms_begin, kingdoms_end),
          (faction_slot_eq, ":cur_kingdom", slot_faction_state, sfs_active),
          (val_add, ":num_active_factions", 1),
        (try_end),
        
        (store_mod, ":mod_value", ":num_active_factions", 2),
        (try_begin),
          (eq, ":mod_value", 0),
          (assign, ":cur_x", 470),
        (else_try),
          (assign, ":cur_x", -30),
        (try_end),
        
        (try_begin),
          (is_between, ":num_active_factions", 1, 3),
          (assign, ":cur_y", 400),
        (else_try),
          (is_between, ":num_active_factions", 3, 5),
          (assign, ":cur_y", 200),
        (else_try),
          (is_between, ":num_active_factions", 5, 7),
          (assign, ":cur_y", 0),
        (else_try),
          (assign, ":cur_y", 20),
        (try_end),
        
        (assign, ":x_offset", 500),
        (assign, ":y_offset", 200),
        
        (assign, ":slot_no", 0),
        (try_for_range_backwards, ":cur_kingdom", kingdoms_begin, kingdoms_end),
          (faction_slot_eq, ":cur_kingdom", slot_faction_state, sfs_active), 
          (try_begin),
            #(is_between, ":cur_kingdom", "fac_kingdom_1", kingdoms_end),
            #(create_image_button_overlay_with_tableau_material, reg1, -1, "tableau_faction_note_mesh", ":cur_kingdom"),
            #(assign, ":totem_x", ":cur_x"),
          #(else_try), # use banner instead
            (create_image_button_overlay_with_tableau_material, reg1, -1, "tableau_faction_note_mesh_banner", ":cur_kingdom"),
            (store_add, ":totem_x", ":cur_x", 90),
          (try_end),
          (position_set_x, pos1, 600),
          (position_set_y, pos1, 600),
          (overlay_set_size, reg1, pos1),
          (position_set_x, pos1, ":totem_x"),
          (position_set_y, pos1, ":cur_y"),
          (overlay_set_position, reg1, pos1),
          (troop_set_slot, "trp_temp_array_a", ":slot_no", reg1),
          (troop_set_slot, "trp_temp_array_b", ":slot_no", ":cur_kingdom"),
          (val_add, ":slot_no", 1),
          
          # bar
          (store_add, ":relation_bar_x", ":cur_x", 270),
          (store_add, ":relation_bar_y", ":cur_y", 10),
          (create_mesh_overlay, reg1, "mesh_relation_bar"),
          (position_set_x, pos1, ":relation_bar_x"),
          (position_set_y, pos1, ":relation_bar_y"),
          (overlay_set_position, reg1, pos1),
          # pointer
          (try_begin),
            (eq, ":cur_kingdom", "fac_player_supporters_faction"),
            (assign, ":cur_relation", 100),
          (else_try),
            (store_relation, ":cur_relation", "fac_player_supporters_faction", ":cur_kingdom"),
          (try_end),
          (store_sub, ":pointer_x", ":cur_relation", -100),
          (val_add, ":pointer_x", 270),
          (val_add, ":pointer_x", ":cur_x"),
          (create_mesh_overlay, reg1, "mesh_reln_pointer"),
          (position_set_x, pos1, ":pointer_x"),
          (position_set_y, pos1, ":relation_bar_y"),
          (overlay_set_position, reg1, pos1),
          # text
          (store_add, ":text_x", ":cur_x", 370),
          (store_add, ":text_y", ":relation_bar_y", 45),
          (assign, reg0, ":cur_relation"),
          (str_store_faction_name, s1, ":cur_kingdom"),
          
          (try_begin),
            (ge, ":cur_relation", 90),
            (str_store_string, s3, "@Loyal"),
          (else_try),
            (ge, ":cur_relation", 80),
            (str_store_string, s3, "@Devoted"),
          (else_try),
            (ge, ":cur_relation", 70),
            (str_store_string, s3, "@Fond"),
          (else_try),
            (ge, ":cur_relation", 60),
            (str_store_string, s3, "@Gracious"),
          (else_try),
            (ge, ":cur_relation", 50),
            (str_store_string, s3, "@Friendly"),
          (else_try),
            (ge, ":cur_relation", 40),
            (str_store_string, s3, "@Supportive"),
          (else_try),
            (ge, ":cur_relation", 30),
            (str_store_string, s3, "@Favorable"),
          (else_try),
            (ge, ":cur_relation", 20),
            (str_store_string, s3, "@Cooperative"),
          (else_try),
            (ge, ":cur_relation", 10),
            (str_store_string, s3, "@Accepting"),
          (else_try),
            (ge, ":cur_relation", 0),
            (str_store_string, s3, "@Indifferent"),
          (else_try),
            (ge, ":cur_relation", -10),
            (str_store_string, s3, "@Suspicious"),
          (else_try),
            (ge, ":cur_relation", -20),
            (str_store_string, s3, "@Grumbling"),
          (else_try),
            (ge, ":cur_relation", -30),
            (str_store_string, s3, "@Hostile"),
          (else_try),
            (ge, ":cur_relation", -40),
            (str_store_string, s3, "@Resentful"),
          (else_try),
            (ge, ":cur_relation", -50),
            (str_store_string, s3, "@Angry"),
          (else_try),
            (ge, ":cur_relation", -60),
            (str_store_string, s3, "@Hateful"),
          (else_try),
            (ge, ":cur_relation", -70),
            (str_store_string, s3, "@Revengeful"),
          (else_try),
            (str_store_string, s3, "@Vengeful"),
          (try_end),
          
            # for current line_faction count lords and centers
            (assign, ":num_lords", 0),
            #(assign, ":num_caravans", 0),
            (assign, ":num_centers", 0),
            (assign, ":unassigned_centers", 0),
            (try_for_parties, ":cur_party"),
                (store_faction_of_party, ":cur_faction", ":cur_party"),
                (eq, ":cur_faction", ":cur_kingdom"),

                (try_begin),
                    (party_slot_eq, ":cur_party", slot_party_type, spt_kingdom_hero_party),
                    (val_add, ":num_lords", 1),
                #(else_try),
                    #(party_slot_eq, ":cur_party", slot_party_type, spt_kingdom_caravan),
                    #(val_add, ":num_caravans", 1),
                (else_try),
                    (this_or_next|party_slot_eq, ":cur_party", slot_party_type, spt_town),
                    (this_or_next|party_slot_eq, ":cur_party", slot_party_type, spt_castle),
                    (party_slot_eq, ":cur_party", slot_party_type, spt_village),
                    (val_add, ":num_centers", 1),

                    (try_begin),
                        (party_slot_eq, ":cur_party", slot_town_lord, stl_unassigned),
                        (val_add, ":unassigned_centers", 1),
                    (try_end),
                (try_end),
            (try_end), # end of parties loop

            # Count prisoners
            (assign, ":prisoners", 0),
            (try_for_range, ":lord_id", active_npcs_begin, active_npcs_end),
                (troop_slot_eq, ":lord_id", slot_troop_occupation, slto_kingdom_hero),
                (troop_slot_ge, ":lord_id", slot_troop_prisoner_of_party, 0),
                (store_troop_faction, ":lord_faction", ":lord_id"),
                (eq, ":lord_faction", ":cur_kingdom"),
                (val_add, ":prisoners", 1),
            (try_end),
          
            (assign, reg61, ":num_centers"),
            (assign, reg58, ":unassigned_centers"),
            #(assign, reg62, ":num_caravans"),
            (assign, reg60, ":num_lords"),
            (assign, reg59, ":prisoners"),
            
            (str_store_string, s4, "@{reg61} {reg58?({reg58} U) :}Centers"),
            #(str_store_string, s5, "@{reg62} Caravans"),
            (str_store_string, s6, "@{reg60} {reg59?({reg59} P) :}Lords"),
          
          (create_text_overlay, reg1, "@{s1}^{s4}^{s6}^{reg0} ({s3})", tf_center_justify),
          (position_set_x, pos1, ":text_x"),
          (position_set_y, pos1, ":text_y"),
          (overlay_set_position, reg1, pos1),
          
          (val_sub, ":cur_x", ":x_offset"),
          (try_begin),
            (eq, ":cur_x", -530),
            (assign, ":cur_x", 470),
            (val_add, ":cur_y", ":y_offset"),
          (try_end),
        (try_end),
        (set_container_overlay, -1),

        ####### mouse fix pos system #######
        #(call_script, "script_mouse_fix_pos_ready"),
        ####### mouse fix pos system #######

        # Done
        (create_game_button_overlay, "$g_presentation_obj_5", "@Done"),
        (position_set_x, pos1, 900),
        (position_set_y, pos1, 25),
        (overlay_set_position, "$g_presentation_obj_5", pos1),
        
        (create_game_button_overlay, "$g_presentation_obj_7", "@relations_with_factions"),
        (position_set_x, pos1, 730),
        (position_set_y, pos1, 25),
        (overlay_set_position, "$g_presentation_obj_7", pos1),
        
      ]),
  
    #(ti_on_presentation_run,
      #[
        ####### mouse fix pos system #######
        #(call_script, "script_mouse_fix_pos_run"),
        ####### mouse fix pos system #######
    #]),
  
    (ti_on_presentation_event_state_change,
      [
        (store_trigger_param_1, ":object"),

        (assign, ":num_active_factions", 0),
        (try_for_range, ":cur_kingdom", kingdoms_begin, kingdoms_end),
          (faction_slot_eq, ":cur_kingdom", slot_faction_state, sfs_active),
          (val_add, ":num_active_factions", 1),
        (try_end),
        (try_for_range, ":slot_no", 0, ":num_active_factions"),
          (troop_slot_eq, "trp_temp_array_a", ":slot_no", ":object"),
          (troop_get_slot, "$temp", "trp_temp_array_b", ":slot_no"),
          (start_presentation, "prsnt_relations_with_lords_by_faction"),
        (try_end),
        
        (try_begin),
          (eq, ":object", "$g_presentation_obj_5"),
          (presentation_set_duration, 0),
        (else_try),
          (eq, ":object", "$g_presentation_obj_7"),
          (start_presentation, "prsnt_faction_relations_report"),
        (try_end),
    ]),
  ]),
